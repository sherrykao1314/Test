<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>外幣保險證照模擬試卷</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>
        /* 試卷風格底色 */
        body { 
            background-color: #e9e9e9; 
            font-family: "Microsoft JhengHei", "PMingLiU", serif; 
            margin: 0; padding: 10px;
            display: flex; justify-content: center;
        }

        /* 模擬紙張樣式 */
        .paper {
            background-color: #fffaf0; /* 象牙白紙張感 */
            width: 100%; max-width: 600px;
            min-height: 90vh;
            padding: 30px 20px;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            border: 1px solid #dcdcdc;
            position: relative;
        }

        /* 試卷標題頭 */
        .exam-header {
            text-align: center;
            border-bottom: 2px solid #000;
            margin-bottom: 20px;
            padding-bottom: 10px;
        }
        .exam-title { font-size: 1.4rem; font-weight: bold; margin: 5px 0; }
        .exam-info { font-size: 0.9rem; color: #555; display: flex; justify-content: space-around; }

        /* 題目區塊 */
        .question-section {
            margin-top: 30px;
            min-height: 150px;
        }
        .q-label { font-weight: bold; font-size: 1.1rem; text-decoration: underline; margin-bottom: 10px; display: block; }
        #question-content { 
            white-space: pre-wrap; 
            font-size: 1.15rem; 
            line-height: 1.8; 
            color: #000;
        }

        /* 答題區：模擬答案卡 */
        .answer-sheet {
            margin-top: 40px;
            border-top: 1px dashed #ccc;
            padding-top: 20px;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }
        .opt-circle {
            width: 50px; height: 50px;
            border: 2px solid #333;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.3rem; font-weight: bold;
            cursor: pointer; background: white;
            margin: auto;
        }
        .opt-circle:active { background: #eee; }

        /* 批改效果 (紅筆感) */
        .correct-mark { border-color: #d63031 !important; color: #d63031 !important; position: relative; }
        .correct-mark::after {
            content: "〇"; position: absolute; font-size: 3rem; opacity: 0.6;
        }
        .wrong-mark { border-color: #636e72 !important; color: #636e72 !important; text-decoration: line-through; }

        #result-text {
            text-align: center; font-size: 1.3rem; font-weight: bold; margin-top: 20px; min-height: 30px;
        }
        .msg-correct { color: #d63031; } /* 紅筆批改色 */
        .msg-wrong { color: #000; }

        /* 下一題按鈕 */
        #next-btn {
            display: none; width: 80%; margin: 30px auto 0; padding: 10px;
            background: #333; color: white; border: none; font-size: 1rem; cursor: pointer;
        }
    </style>
</head>
<body>

<div class="paper">
    <div class="exam-header">
        <div class="exam-title">外幣收付非投資型保險模擬測驗</div>
        <div class="exam-info">
            <span>科目：外幣法規實務</span>
            <span>題型：單選題</span>
        </div>
    </div>

    <div class="question-section">
        <span class="q-label" id="q-num">第 -- 題</span>
        <div id="question-content">試卷準備中...</div>
    </div>

    <div class="answer-sheet">
        <div class="opt-circle" onclick="submit('A', this)">A</div>
        <div class="opt-circle" onclick="submit('B', this)">B</div>
        <div class="opt-circle" onclick="submit('C', this)">C</div>
        <div class="opt-circle" onclick="submit('D', this)">D</div>
    </div>

    <div id="result-text"></div>
    <button id="next-btn" onclick="nextQ()">下一題 (Next)</button>
    
    <div style="margin-top: 50px; text-align: center; color: #ccc; font-size: 0.8rem;">
        ※ 本試卷隨機抽取題庫供模擬練習使用
    </div>
</div>

<script>
    const csvUrl = '你的_Google_Sheets_CSV_網址';
    let bank = [];
    let current = null;
    let count = 0;

    Papa.parse(csvUrl, {
        download: true, header: true,
        complete: function(r) {
            bank = r.data.filter(i => i.正確答案);
            nextQ();
        }
    });

    function nextQ() {
        count++;
        current = bank[Math.floor(Math.random() * bank.length)];
        
        document.getElementById('q-num').innerText = `第 ${count} 題`;
        document.getElementById('question-content').innerText = current.題目內容;
        document.getElementById('result-text').innerText = "";
        document.getElementById('next-btn').style.display = "none";
        
        document.querySelectorAll('.opt-circle').forEach(el => {
            el.className = 'opt-circle';
            el.style.pointerEvents = 'auto';
        });
    }

    function submit(ans, el) {
        const correct = current.正確答案.trim().toUpperCase();
        const res = document.getElementById('result-text');
        
        document.querySelectorAll('.opt-circle').forEach(e => e.style.pointerEvents = 'none');

        if (ans === correct) {
            el.classList.add('correct-mark');
            res.innerHTML = '<span class="msg-correct">✓ 正確</span>';
        } else {
            el.classList.add('wrong-mark');
            res.innerHTML = `<span class="msg-wrong">✕ 錯誤 (正解：${correct})</span>`;
        }
        
        document.getElementById('next-btn').style.display = "block";
    }
</script>

</body>
</html>
